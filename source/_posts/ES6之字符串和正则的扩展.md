---
title: ES6之字符串和正则的扩展
date: 2017-9-20 19:33:44
toc: true
tags:
    - JavaScript
    - ES6
---
ES6 扩展了字符串和正则
<!--more-->
#### 1字符串的扩展
##### 1.1 字符的Unicode表示法
```
"\u{20BB7}"
```
##### 1.2 codePointAt()
- javaScript内部，字符以UTF-16的格式储存，每个字符固定为2个字节。对于那些需要4个字节储存的字符（Unicode码点大于0xFFFF的字符），JavaScript会认为它们是两个字符。
- S6提供了```codePointAt(index)```方法，能够正确处理4个字节储存的字符，返回一个字符的码点。（用for...of循环才能正确的使用index）
    ```
    let s = '𠮷a';
    for (let ch of s) {
      console.log(ch.codePointAt(0));
    }
    ```
- codePointAt对于那些两个字节储存的常规字符，它的返回结果与charCodeAt方法相同。
- 转换进制(10进制转16进制)
    ```
    s.codePointAt(0).toString(16)
    ```
##### 1.3 String.fromCodePoint()
解决ES5中String.fromCharCode方法不能识别32位的UTF-16字符

##### 1.4 字符串的遍历器接口
ES6为字符串添加了遍历器接口，使得字符串可以被for...of循环遍历

##### 1.5 normalize()
欧洲语言有语调符号和重音符号

##### 1.6 includes(),startsWith(),endsWith()
- 对应JS中indexof()
```
//都支持第2个参数，表示开始搜索的位置
includes(字符串)  //返回布尔值，表示是否找到了参数字符串。
startsWith(字符串)//返回布尔值，表示参数字符串是否在原字符串的头部。
endsWith(字符串)  //返回布尔值，表示参数字符串是否在原字符串的尾部。
```
##### 1.7 repeat()
- 返回一个新字符串，表示将原字符串重复n次。参数如果是小数，会被向下取整。
    ```
    'x'.repeat(3) // "xxx"
    ```
##### 1.8 padStart(),padEnd()
- 接受2个参数： 第一个参数用来指定字符串的最小长度，第二个参数是用来补全的字符串。
- 如果原字符串的长度，等于或大于指定的最小长度，则返回原字符串。
```
padStart()  //用于头部补全
padEnd()    //用于尾部补全

'x'.padStart(4, 'ab') // 'abax'
```
- padStart的常见用途是为数值补全指定位数。下面代码生成10位的数值字符串。
- 另一个用途是提示字符串格式。
    ```
    '12'.padStart(10, 'YYYY-MM-DD') // "YYYY-MM-12"
    '09-12'.padStart(10, 'YYYY-MM-DD') // "YYYY-09-12"
    ```
##### 1.9 模板字符串
- 模板字符串（template string）是增强版的字符串，**用反引号（`）标识**。它可以当作普通字符串使用，也可以用来定义多行字符串，或者在字符串中嵌入变量
- 字符串中嵌入变量，将变量名写在```${}```之中。
    - 大括号内部可以放入任意的JavaScript表达式，可以进行运算，以及引用对象属性。
    - 还能调用函数
    - 如果大括号内部是一个字符串，将会原样输出。
    - 还能嵌套
    ```
    // 字符串中嵌入变量
    let name = "Bob", time = "today";
    `Hello ${name}, how are you ${time}?`
    ```
- 如果使用模板字符串表示多行字符串，所有的空格和缩进都会被保留在输出之中

##### 1.10 实例：模板编译
##### 1.11 标签模板
- 它可以紧跟在一个函数名后面，该函数将被调用来处理这个模板字符串。这被称为“标签模板”功能（tagged template）。
    ```
    alert`123`
    // 等同于
    alert(123)
    ```
- “标签模板”的一个重要应用，就是过滤 HTML 字符串，防止用户输入恶意内容。

##### 1.12 String.raw()
- ES6还为原生的String对象，提供了一个raw方法。
- ```String.raw```方法，往往用来充当模板字符串的处理函数，返回一个斜杠都被转义（即斜杠前面再加一个斜杠）的字符串，对应于替换变量后的模板字符串。
- 如果原字符串的斜杠已经转义，那么```String.raw```不会做任何处理。

##### 1.13 模板字符串的限制
模板字符串默认会将字符串转义，导致无法嵌入其他语言。

#### 2 正则的扩展
##### 2.1 RegExp构造函数
ES5 不允许此时使用第二个参数添加修饰符，否则会报错。但ES6允许
```
new RegExp(/abc/ig, 'i')
//原有正则对象的修饰符是ig，它会被第二个参数i覆盖。
```
##### 2.2 字符串的正则方法
- 字符串对象共有4个方法，可以使用正则表达式：match()、replace()、search()和split()。
- ES6 将这4个方法，在语言内部全部调用RegExp的实例方法，从而做到所有与正则相关的方法，全都定义在RegExp对象上。

##### 2.3 u修饰符
ES6 对正则表达式添加了u修饰符，含义为“Unicode模式”，用来正确处理大于\uFFFF的 Unicode 字符。也就是说，会正确处理四个字节的 UTF-16 编码。
##### 2.4 y修饰符
- “粘连”（sticky）修饰符。
- y修饰符的作用与g修饰符类似，也是全局匹配，后一次匹配都从上一次匹配成功的下一个位置开始。
- 不同之处在于，g修饰符只要剩余位置中存在匹配就可，而y修饰符确保匹配必须从剩余的**第一个位置**开始

##### 2.5 ysticky属性
sticky属性，表示是否设置了y修饰符。
```
var r = /hello\d/y;
r.sticky // true
```
##### 2.6 flags属性
返回正则表达式的修饰符。
```
// ES5 的 source 属性
// 返回正则表达式的正文
/abc/ig.source
// "abc"

// ES6 的 flags 属性
// 返回正则表达式的修饰符
/abc/ig.flags
// 'gi'
```